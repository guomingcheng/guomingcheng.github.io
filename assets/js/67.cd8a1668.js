(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{438:function(t,a,s){"use strict";s.r(a);var n=s(46),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"创建项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[t._v("#")]),t._v(" 创建项目")]),t._v(" "),s("p",[t._v("创建一个 hardhat 的项目，依次的执行下面的命令")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\nnpm init\nnpm install "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev hardhat\nnpx hardhat\nnpm install "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev @nomiclabs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("waffle ethereum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("waffle chai @nomiclabs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ethers ethers\nyarn add "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("dev @nomicfoundation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("toolbox @nomicfoundation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("network"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("helpers @nomicfoundation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("chai"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("matchers @nomiclabs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ethers @nomiclabs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("etherscan chai ethers hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("gas"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reporter solidity"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("coverage @typechain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat typechain @typechain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ethers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v5 @ethersproject"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("abi @ethersproject"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("providers\n\n")])])]),s("h2",{attrs:{id:"config-配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#config-配置文件"}},[t._v("#")]),t._v(" config 配置文件")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置编译")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置网络")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置开源参数")]),t._v("\n    \n")])])]),s("h2",{attrs:{id:"单文件开源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单文件开源"}},[t._v("#")]),t._v(" 单文件开源:")]),t._v(" "),s("p",[t._v("  使用单个文件合约开源，只需要借助 hardhat 工具把多个文件合并即可")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("                        要合并的合约路径                       输出目录\nnpx hardhat flatten contracts\\workbook\\Delegatecall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sol  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  box"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sol\n")])])]),s("h2",{attrs:{id:"多文件开源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多文件开源"}},[t._v("#")]),t._v(" 多文件开源:")]),t._v(" "),s("p",[t._v("   多文件的合约开源，需要借助 hardhat 工具来完成，在浏览器中很能实现多个文件开源")]),t._v(" "),s("h5",{attrs:{id:"_1-安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装依赖"}},[t._v("#")]),t._v(" 1. 安装依赖")]),t._v(" "),s("div",{staticClass:"language-angular2 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('  "@nomiclabs/hardhat-etherscan": "^3.1.0",                    // 合约开源工具\n  "@openzeppelin/contracts": "^4.7.3",                         // 代码库            \n  "undici": "^5.10.0"                                          // 代理配置        \n')])])]),s("h5",{attrs:{id:"_2-配置文件-hardhat-config-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置文件-hardhat-config-js"}},[t._v("#")]),t._v(" 2. 配置文件 hardhat.config.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开源的工具包，合约开源需要借助这个工具包")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@nomiclabs/hardhat-etherscan"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为 hardhat 工具配置代理，不然总是连接超时，这个需要注意")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ProxyAgent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setGlobalDispatcher "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"undici"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxyAgent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProxyAgent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:7891'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里就是本地的代理端口")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setGlobalDispatcher")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxyAgent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** @type import('hardhat/config').HardhatUserConfig */")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置编译器版本，以及编译参数  ")]),t._v("\n  solidity"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0.8.4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    settings"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      optimizer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        enabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        runs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置网络")]),t._v("\n  networks"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    bscTestnet"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://nd-518-217-842.p2pify.com/f7d1bc5feaebcdf4f03186435c7949be'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      accounts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3601d568b8436e97cc5e9a80b7e2e43d7095784b3002cd23a4662aa3a65c70ca'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置合约开源参数")]),t._v("\n  etherscan"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开源多个文件的合约需要使用到 BINANCE 浏览器生成的一个 KEY, ")]),t._v("\n    apiKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每一个网络对于的一个 KEY  ")]),t._v("\n      bscTestnet"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'F53ANW6FZUXDT333YCQ6HJR36P8HDT62QK'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里配置的是合约要开源对于的链的信息。")]),t._v("\n    customChains"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        network"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bscTestnet"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        chainId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("97")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        urls"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          apiURL"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://api-testnet.bscscan.com/api"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          browserURL"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://testnet.bscscan.com"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h5",{attrs:{id:"_3-开源命令以及参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-开源命令以及参数"}},[t._v("#")]),t._v(" 3. 开源命令以及参数")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("contracts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("DispatcherV2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sol"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("TestContracts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 入口合同路径"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 这个参数添好即可"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" 程序会自动引入依赖的文件\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("network bscTestnet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 要把合约开源到那个网络\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x06f25145fea1594947f72eC1782581614a60e170")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 开源的合约地址\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("                                          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 如果开源的合约有构造参数，按照构造参数的顺序在后面追加即可\n\nnpx hardhat verify "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("contract contracts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("DispatcherV2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sol"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("TestContracts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("network bscTestnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x06f25145fea1594947f72eC1782581614a60e170")]),t._v("\n")])])]),s("h2",{attrs:{id:"工具包-hardhat-toolbox"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工具包-hardhat-toolbox"}},[t._v("#")]),t._v(" 工具包 hardhat-toolbox")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("runner"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nomicfoundation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("hardhat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("toolbox\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);