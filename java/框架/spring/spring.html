<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>初识 | 文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/index.css">
    <script src="/js/index.js"></script>
    <meta name="description" content="个人文档">
    
    <link rel="preload" href="/assets/css/0.styles.8cd2006c.css" as="style"><link rel="preload" href="/assets/js/app.ce1393de.js" as="script"><link rel="preload" href="/assets/js/2.ee68cb5d.js" as="script"><link rel="preload" href="/assets/js/21.fcc0c1f7.js" as="script"><link rel="prefetch" href="/assets/js/10.fae9557b.js"><link rel="prefetch" href="/assets/js/11.ec03d5d9.js"><link rel="prefetch" href="/assets/js/12.aa5ec6e6.js"><link rel="prefetch" href="/assets/js/13.fa27dbe3.js"><link rel="prefetch" href="/assets/js/14.27428945.js"><link rel="prefetch" href="/assets/js/15.e19dc613.js"><link rel="prefetch" href="/assets/js/16.ac5d0041.js"><link rel="prefetch" href="/assets/js/17.b015baa0.js"><link rel="prefetch" href="/assets/js/18.d790bc9c.js"><link rel="prefetch" href="/assets/js/19.7f450609.js"><link rel="prefetch" href="/assets/js/20.504a3fd4.js"><link rel="prefetch" href="/assets/js/22.1e27d5c1.js"><link rel="prefetch" href="/assets/js/23.e7de804c.js"><link rel="prefetch" href="/assets/js/24.89d96b41.js"><link rel="prefetch" href="/assets/js/25.47d860f4.js"><link rel="prefetch" href="/assets/js/26.03bbdba6.js"><link rel="prefetch" href="/assets/js/27.adba25d3.js"><link rel="prefetch" href="/assets/js/28.51f6ec86.js"><link rel="prefetch" href="/assets/js/29.3d75e6eb.js"><link rel="prefetch" href="/assets/js/3.af3b0f40.js"><link rel="prefetch" href="/assets/js/30.3ea92647.js"><link rel="prefetch" href="/assets/js/31.50e89190.js"><link rel="prefetch" href="/assets/js/32.2330f5a5.js"><link rel="prefetch" href="/assets/js/33.3db8ae98.js"><link rel="prefetch" href="/assets/js/34.b38625c8.js"><link rel="prefetch" href="/assets/js/35.49492a46.js"><link rel="prefetch" href="/assets/js/36.5a949c11.js"><link rel="prefetch" href="/assets/js/37.e1595cca.js"><link rel="prefetch" href="/assets/js/38.5e66f157.js"><link rel="prefetch" href="/assets/js/39.e118d131.js"><link rel="prefetch" href="/assets/js/4.dcedff1a.js"><link rel="prefetch" href="/assets/js/40.9b43fbc7.js"><link rel="prefetch" href="/assets/js/41.d9116c83.js"><link rel="prefetch" href="/assets/js/42.95c96c90.js"><link rel="prefetch" href="/assets/js/43.a92421aa.js"><link rel="prefetch" href="/assets/js/44.e19be0d2.js"><link rel="prefetch" href="/assets/js/45.def7c4a5.js"><link rel="prefetch" href="/assets/js/46.b4d92a6e.js"><link rel="prefetch" href="/assets/js/47.de8d2dc3.js"><link rel="prefetch" href="/assets/js/48.21f95edd.js"><link rel="prefetch" href="/assets/js/49.26d21bfa.js"><link rel="prefetch" href="/assets/js/5.1bf7576d.js"><link rel="prefetch" href="/assets/js/50.1ea86b8f.js"><link rel="prefetch" href="/assets/js/51.034e7576.js"><link rel="prefetch" href="/assets/js/52.9afafe11.js"><link rel="prefetch" href="/assets/js/53.688c4d83.js"><link rel="prefetch" href="/assets/js/54.13bfb729.js"><link rel="prefetch" href="/assets/js/55.e066dc58.js"><link rel="prefetch" href="/assets/js/56.c036e408.js"><link rel="prefetch" href="/assets/js/57.007d50cf.js"><link rel="prefetch" href="/assets/js/58.3f670fa2.js"><link rel="prefetch" href="/assets/js/59.f41e8ae6.js"><link rel="prefetch" href="/assets/js/6.8cf2a95e.js"><link rel="prefetch" href="/assets/js/60.f0fda430.js"><link rel="prefetch" href="/assets/js/61.ae4987fd.js"><link rel="prefetch" href="/assets/js/62.3c3e0b82.js"><link rel="prefetch" href="/assets/js/63.87900c10.js"><link rel="prefetch" href="/assets/js/64.9ffbb746.js"><link rel="prefetch" href="/assets/js/65.52ffe053.js"><link rel="prefetch" href="/assets/js/66.0b20125c.js"><link rel="prefetch" href="/assets/js/67.cd8a1668.js"><link rel="prefetch" href="/assets/js/68.97020436.js"><link rel="prefetch" href="/assets/js/69.533a79a4.js"><link rel="prefetch" href="/assets/js/7.299203e9.js"><link rel="prefetch" href="/assets/js/70.29933dd9.js"><link rel="prefetch" href="/assets/js/71.f88421fc.js"><link rel="prefetch" href="/assets/js/72.95de2bad.js"><link rel="prefetch" href="/assets/js/73.4a4257cc.js"><link rel="prefetch" href="/assets/js/74.659aab88.js"><link rel="prefetch" href="/assets/js/75.cadd4a65.js"><link rel="prefetch" href="/assets/js/76.254b9f42.js"><link rel="prefetch" href="/assets/js/77.e5b5a87b.js"><link rel="prefetch" href="/assets/js/78.b1b2dd8d.js"><link rel="prefetch" href="/assets/js/79.cbbbe000.js"><link rel="prefetch" href="/assets/js/8.c093787a.js"><link rel="prefetch" href="/assets/js/80.2b85c169.js"><link rel="prefetch" href="/assets/js/81.c6f26762.js"><link rel="prefetch" href="/assets/js/9.010ac11f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8cd2006c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/区块链.html" class="nav-link">
  区块链
</a></div><div class="nav-item"><a href="/英语.html" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/前端.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/疑问解述篇.html" class="nav-link">
  疑问解述篇
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/区块链.html" class="nav-link">
  区块链
</a></div><div class="nav-item"><a href="/英语.html" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/前端.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/疑问解述篇.html" class="nav-link">
  疑问解述篇
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/框架/spring/spring.html" class="active sidebar-link">spring</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#初识" class="sidebar-link">初识</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#配置类开发" class="sidebar-link">配置类开发</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#条件注册-bean" class="sidebar-link">条件注册 Bean</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#import-注册-bean" class="sidebar-link">Import 注册 Bean</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#生命周期" class="sidebar-link">生命周期</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#di-依赖注入" class="sidebar-link">DI 依赖注入</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#aware" class="sidebar-link">Aware</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#aop" class="sidebar-link">AOP</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#transactional" class="sidebar-link">Transactional</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#注解整合-ssm" class="sidebar-link">注解整合 ssm</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#ssm-集成-mp-plus" class="sidebar-link">ssm 集成 mp-plus</a></li><li class="sidebar-sub-header"><a href="/java/框架/spring/spring.html#ssm-整合-logback-日志" class="sidebar-link">ssm 整合 logback 日志</a></li></ul></li><li><a href="/java/框架/mybatis_plus/mybatis-plus.html" class="sidebar-link">mybatisPlus</a></li><li><a href="/java/框架/mybatis/mybatis.html" class="sidebar-link">mybatis</a></li><li><a href="/java/框架/spring_mvc/spring_mvc.html" class="sidebar-link">springMvc</a></li><li><a href="/java/框架/springboot/springboot.html" class="sidebar-link">springBoot</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="初识"><a href="#初识" class="header-anchor">#</a> 初识</h2> <h4 id="spring-的是为了简化-web-开发而孕育而生"><a href="#spring-的是为了简化-web-开发而孕育而生" class="header-anchor">#</a> <div class="biaoti2"></div> spring 的是为了简化 web 开发而孕育而生</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">spring 是一种开源轻量级一站式框架，是为了解决企业应用开发复杂性而产生的。spring 之力与解决 javaEE 的各层解决方案，也就是所谓的一站式的。</span> <span style="font-size:13px;"><br> spring 坚持的唯一原则: </span></p> <blockquote><p><span style="font-size:13px;"> 在市场上已有较好的解决方案，就不会重复性造轮子，并与第三方解决方案提供了良好集成。在第三方组件提供简化开发模本，如: http、 redis、jdbc、activemq</span></p></blockquote></blockquote> <h2 id="配置类开发"><a href="#配置类开发" class="header-anchor">#</a> 配置类开发</h2> <h4 id="新的-spring-配置开发模式-java-类与-xml-配置等价的"><a href="#新的-spring-配置开发模式-java-类与-xml-配置等价的" class="header-anchor">#</a> <div class="biaoti2"></div> 新的 spring 配置开发模式，java 类与 xml 配置等价的</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 spring 核心依赖 jar 包</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-04.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、java Configuration 配置类创建与介绍</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-05.png" alt="An image"></p><div style="margin-top:-10px;"><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-07.png" alt="An image"></div><p></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">3、读取配置文件, 获取托管给 spring 的 Bean </span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-06.png" alt="An image"></p></blockquote></blockquote> <h4 id="includefilters-或者是-excludefilters-使用-filtertype-设置范围如下"><a href="#includefilters-或者是-excludefilters-使用-filtertype-设置范围如下" class="header-anchor">#</a> <div class="biaoti2"></div> includeFilters 或者是 excludeFilters ，使用 FilterType 设置范围如下</h4> <div style="font-size:12px;"><table><thead><tr><th>类型</th> <th style="text-align:left;">类型名称</th> <th style="text-align:center;">范围</th> <th style="text-align:center;">说明</th></tr></thead> <tbody><tr><td>ANNOTATION</td> <td style="text-align:left;">注解</td> <td style="text-align:center;">较大</td> <td style="text-align:center;">作用范围在注解上, 如: 被 @Controller 贴上的每个类, 不是被排除不被 spring 托管、就是只被扫描提供给 spring 托管</td></tr> <tr><td>ASSIGNABLE_TYPE</td> <td style="text-align:left;">类型</td> <td style="text-align:center;">较小</td> <td style="text-align:center;">作用范围只在一个类上, 如: 值是 SpringService.class , 不是被排除不被 spring 托管、就是只被扫描提供给 spring 托管</td></tr></tbody></table></div> <h2 id="条件注册-bean"><a href="#条件注册-bean" class="header-anchor">#</a> 条件注册 Bean</h2> <h4 id="也就是说-当一个-bean-满足一个条件后-才会被-spring-ioc-托管"><a href="#也就是说-当一个-bean-满足一个条件后-才会被-spring-ioc-托管" class="header-anchor">#</a> <div class="biaoti2"></div> 也就是说，当一个 Bean 满足一个条件后，才会被 spring IOC 托管</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 spring 核心依赖 jar 包</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-04.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、在使用 @Configuration 配置文件时，通过 @Bean 注解来把 java 对象实列往 spring IOC 容器注册进去。@Bean 我是可以选择性的注册进去，也就是条件注册，需要实现 spring 提供的 Condition 接口，如下:</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-08.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">3、在配置文件中那个 @Bean 需要选择性的注册。需要使用 @Conditional 注解, 值就是实现 spring 提供的接口。 如下:</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-09.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">4、结果: 这个选择性注册 Bean, 表示在 liunx 系统下运行程序就会注册该 Bean, 否则该 Bean 就不会注册</span></p> <blockquote><p><span style="font-size:13px;">注意: 可以在设置中改变程序获取操作系统的，如 VM options : -Dos.name=liunx</span></p></blockquote></blockquote> <h2 id="import-注册-bean"><a href="#import-注册-bean" class="header-anchor">#</a> Import 注册 Bean</h2> <h4 id="bean-是-spring-的核心-也提供各种各样注册-bean-的方式-import-也将是其中的一种"><a href="#bean-是-spring-的核心-也提供各种各样注册-bean-的方式-import-也将是其中的一种" class="header-anchor">#</a> <div class="biaoti2"></div>  Bean 是 spring 的核心，也提供各种各样注册 Bean 的方式，Import 也将是其中的一种</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 spring 核心依赖 jar 包</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-04.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、将 spring 提供俩种接口分别是 ImportSelector 与 ImportBeanDefinitionRegistrar 来自己添加 Bean 注入 IOC 容器中</span></p> <blockquote><p><span style="font-size:13px;">2.1 ImportSelector 接口实现: </span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-10.png" alt="An image"> <span style="font-size:13px;">2.2 ImportBeanDefinitionRegistrar 接口实现: </span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-11.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">3、在配置文件中，使用 @Import 注解加载俩个实现接口，让接口添加的 Bean 注册到 IOC 容器中</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-12.png" alt="An image"></p></blockquote></blockquote> <h2 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h2> <h4 id="bean-的创建-初始化-销毁"><a href="#bean-的创建-初始化-销毁" class="header-anchor">#</a> <div class="biaoti2"></div>  Bean 的创建 --&gt; 初始化 --&gt; 销毁</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">Bean 的初始化: </span></p> <blockquote><p><span style="font-size:13px;">在使用 @Bean 注解时，有一个 initMethod 属性可以指定当前 Bean 的一个方法名。当每到创建 Bean 的实列时，就会调用指定的方法来初始化。 </span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-13.png" alt="An image"></p></blockquote></blockquote> <blockquote><blockquote><p><span style="font-size:13px;">Bean 注解也有个 destroyMethod 属性来指定当前 Bean 的一个方法名, 当 Bean 的实列销毁时就会调用该方法。在 spring 中单列 Bean 在容器销毁时也跟着销毁，多列的就会交给 GC 来处理，销毁的方法调用不稳定 </span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-14.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;"> 第二种实现 Bean 创建时调用初始化方法与销毁时调用的方法。 </span></p> <blockquote><p><span style="font-size:13px;">@PostConstrut : 贴在类的一个方法上，当该类托管给 spring IOC 容器创建完成时，就会调用该方法初始化</span> <span style="font-size:13px;">@PreDestroy : 贴在类的一个方法上，当类销毁时会调用该方法做最后的清理工作  </span></p></blockquote></blockquote> <h2 id="di-依赖注入"><a href="#di-依赖注入" class="header-anchor">#</a> DI 依赖注入</h2> <h4 id="属性依赖注入-介绍普通类型与对象类型概念和使用"><a href="#属性依赖注入-介绍普通类型与对象类型概念和使用" class="header-anchor">#</a> <div class="biaoti2"></div> 属性依赖注入, 介绍普通类型与对象类型概念和使用</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、配置文件介绍: </span></p> <blockquote><p><span style="font-size:13px;">在配置文件中使用了 @PropertySource 注解, 用于加载属性文件的。与使用了 @Primary 注解为该 Bean 提高依赖注入优先级</span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-15.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、属性注入注解介绍: </span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-16.png" alt="An image"></p></blockquote></blockquote> <h4 id="autowired-注解-可以有多种方式进行依赖注入"><a href="#autowired-注解-可以有多种方式进行依赖注入" class="header-anchor">#</a> <div class="biaoti2"></div> @Autowired 注解，可以有多种方式进行依赖注入</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、作用在构造方法上，当对象创建时，会注入对于的参数</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-17.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、作用于 set 方法上，当对象创建时，会注入对于的参数</span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-18.png" alt="An image"></p></blockquote></blockquote> <h2 id="aware"><a href="#aware" class="header-anchor">#</a> Aware</h2> <h4 id="获取-spring-内部数据"><a href="#获取-spring-内部数据" class="header-anchor">#</a> <div class="biaoti2"></div> 获取 spring 内部数据</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">在 spring 中, 有许多继承了 Aware 接口，这些接口可以为我们获取 sprin 内部数据, 上下文对象、系统环境变量对象、解析器对象等等操作。只要实现提供的接口并注册到 IOC 容器即可: </span></p> <blockquote><p><span style="font-size:13px;">这些接口都是以 Aware 结尾的，当 spring 一切都初始化完毕后</span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-19.png" alt="An image"></p></blockquote></blockquote> <h2 id="aop"><a href="#aop" class="header-anchor">#</a> AOP</h2> <h4 id="aop-面向切面编程-提供了业务之间的隔离性"><a href="#aop-面向切面编程-提供了业务之间的隔离性" class="header-anchor">#</a> <div class="biaoti2"></div> Aop 面向切面编程，提供了业务之间的隔离性</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">Aop 面向切面编程是 spring 的核心组件, 可以让方法只关注与业务, 让如 log 日志打印交给增强的方法实现。spring 的 Aop 是使用 Cglib 动态代理与 jdk 动态代理实现。</span></p></blockquote> <h4 id="aop-使用介绍"><a href="#aop-使用介绍" class="header-anchor">#</a> <div class="biaoti2"></div> Aop 使用介绍</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 Aop 的核心 jar 包 </span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-21.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、配置文件设置</span></p> <blockquote><p><span style="font-size:13px;">在核心配置文件需要添加 @EnableAspectJAutoProxy 注解, 否则 AOP 的功能是无效的。</span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-20.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">3、核心增强类</span></p> <blockquote><p><span style="font-size:13px;">在添加增强类后，一个切面类配置就完成了，接下来只需要关注切面表达式，根据设置的表达式要对那些类的那些方法进行增强，字符可以用 * 号来替代，表达式所有。</span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-22.png" alt="An image"></p></blockquote></blockquote> <h2 id="transactional"><a href="#transactional" class="header-anchor">#</a> Transactional</h2> <h4 id="事务的处理将是交给-spring-可以更好的业务实现"><a href="#事务的处理将是交给-spring-可以更好的业务实现" class="header-anchor">#</a> <div class="biaoti2"></div> 事务的处理将是交给 spring ，可以更好的业务实现</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 Aop 的核心 jar 包 </span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-23.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、配置事务的生效</span></p> <blockquote><p><span style="font-size:13px;">使用了 @EnableTransactionManagement 注解，表示开启注解声明式事务，@Transaction 才会生效。一个注意点: 一下俩个 Bean 都调用 dataSource() 方法获取数据源，但是他们是同一个数据源的实列，而不是俩个实列 </span> <img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-24.png" alt="An image"></p></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">1、Dao 层使用声明式事务与 jdbc 模本来操作数据库 </span></p> <blockquote><p><img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-25.png" alt="An image"></p></blockquote></blockquote> <h2 id="注解整合-ssm"><a href="#注解整合-ssm" class="header-anchor">#</a> 注解整合 ssm</h2> <h4 id="纯注解开发-整合-spring-springmvc-mybtais-框架"><a href="#纯注解开发-整合-spring-springmvc-mybtais-框架" class="header-anchor">#</a> <div class="biaoti2"></div>  纯注解开发，整合 spring springmvc mybtais 框架</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、添加 ssm 依赖的 jar </span></p> <blockquote><div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- servlet 依赖 --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javax.servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- mvc 包含 spring 的核心 jar --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- mysql 驱动 --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- 数据源 --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.16<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- mybatis 的依赖--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- mybatis 与 spring 整合的 jar--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- spring aop 依赖的 jar 包--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aspects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!-- Lombok --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.18.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

     <span class="token comment">&lt;!-- jdbc、事务依赖  --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>


 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、创建 tomcat 启动加载核心的 类</span></p> <blockquote><p>实现了 AbstractAnnotationConfig DispatcherServletInitializer 接口后，tomcat 启动就会加载该类的 getRootConfigClasses 与 getServletConfigClasses 俩个方法。这俩个方法返回的配置文件类就是初始化到容器的 Bean ,与那些相关的配置。接来实现这些核心类。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* @program:   tomcat 启动后创建的对象，调用方法来初始化容器以前的控制器
* @Date: 2019/9/13 0013 14:30
* @Author: guoMingCheng
* @Description:
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebAppInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAnnotationConfigDispatcherServletInitializer</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Override</span>  <span class="token comment">// 根容器, 负责 service dao 的 Bean 的创建, 以及事务的这块</span>
   <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getRootConfigClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">RootConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>  <span class="token comment">// 子容器, 负责 controller 的 Bean 的创建, 以及映射和视图配置等等..</span>
   <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getServletConfigClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">WebMvcConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>  <span class="token comment">// 配置 dispatcherservlet 拦截路径,  / 斜杆表示拦截所有但不饱和 jsp</span>
   <span class="token keyword">protected</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getServletMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>  <span class="token comment">// 配置过滤器或者配置监听 tomcat 启动</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onStartup</span><span class="token punctuation">(</span><span class="token class-name">ServletContext</span> servletContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>

       <span class="token comment">// 配置字符集过滤器</span>
       servletContext<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">&quot;characterEncoding&quot;</span> <span class="token punctuation">,</span> <span class="token class-name">CharacterEncodingFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addMappingForUrlPatterns</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">,</span> <span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">// 监听 tomcat 启动与销毁, 用于关闭数据源的连接池. 不然关闭连 tomcat 会提示错误信息</span>
       servletContext<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyServletContextListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onStartup</span><span class="token punctuation">(</span>servletContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre></div></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">3、实现核心类以及配置类</span></p> <blockquote><p>3.1: 实现 RootConfig 根容器配置类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* @program: 根容器配置文件
* @Date: 2019/9/13 0013 14:40
* @Author: guoMingCheng
* @Description:
*/</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>  <span class="token comment">//开启事务</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;com.guomingcheng&quot;</span> <span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>
       <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>ANNOTATION <span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RootConfig</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 注册数据源
   */</span>
  <span class="token annotation punctuation">@Bean</span>  
  <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

      <span class="token class-name">DruidDataSource</span> druidDataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      druidDataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      druidDataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;gmC24354.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      druidDataSource<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      druidDataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc:mysql://127.0.0.1:3306/ruiyue?characterEncoding=utf-8&quot;</span> <span class="token operator">+</span>
              <span class="token string">&quot;&amp;serverTimezone=GMT%2B8&amp;useSSL=false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> druidDataSource<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token comment">/**
   *  注册事务
   */</span>
  <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;dataSourceTransactionManager&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">DataSourceTransactionManager</span> <span class="token function">getDataSourceTransactionManager</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceTransactionManager</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * SqlSession 工厂
   * @param dataSource 数据源，会在 IOC 中获取
   */</span>
  <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;sqlSessionFactoryBean&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactoryBean</span> <span class="token function">getSqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
      <span class="token class-name">SqlSessionFactoryBean</span> factoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 设置 MyBatis 配置文件路径</span>
      <span class="token comment">// factoryBean.setConfigLocation(new ClassPathResource(&quot;mybatis-config.xml&quot;));</span>
      <span class="token comment">// 设置 SQL 映射文件路径</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:mybatis/*.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 设置 JavaBean 类型别名，在 SQL 映射文件中就不用写全类名</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setTypeAliasesPackage</span><span class="token punctuation">(</span><span class="token string">&quot;com.guomingcheng.pojo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> factoryBean<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 注册扫描 Mapper 的类
   */</span>
  <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;mapperScannerConfigurer&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">MapperScannerConfigurer</span> <span class="token function">getMapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">MapperScannerConfigurer</span> mappper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      mappper<span class="token punctuation">.</span><span class="token function">setBasePackage</span><span class="token punctuation">(</span><span class="token string">&quot;com.guomingcheng.dao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 扫描 mapper 接口</span>

      <span class="token keyword">return</span> mappper<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>

</code></pre></div><br> <p>3.2: 实现 WebMvcConfig 子容器配置类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* @program:
* @Date: 2019/9/13 0013 14:45
* @Author: guoMingCheng
* @Description:
*/</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;com.guomingcheng&quot;</span> <span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>
       <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>ANNOTATION<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableWebMvc</span>  <span class="token comment">//使用该注解, 可使用 WebMvcConfigurer 接口可以扩展配置</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * mvc 处理不了的请求交给 Servlet 来处理, .html .img .css 静态文件
   * 相当于：&lt;mvc:default-servlet-handler/&gt; 开启静态资源的访问的开关
   */</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureDefaultServletHandling</span><span class="token punctuation">(</span><span class="token class-name">DefaultServletHandlerConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      configurer<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启用默认Servlet支持</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   *  配置视图解析器
   */</span>
  <span class="token annotation punctuation">@Bean</span>
  <span class="token keyword">public</span> <span class="token class-name">InternalResourceViewResolver</span> <span class="token function">viewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">InternalResourceViewResolver</span> viewResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalResourceViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      viewResolver<span class="token punctuation">.</span><span class="token function">setPrefix</span><span class="token punctuation">(</span><span class="token string">&quot;/WEB-INF/view/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      viewResolver<span class="token punctuation">.</span><span class="token function">setSuffix</span><span class="token punctuation">(</span><span class="token string">&quot;.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> viewResolver<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>

</code></pre></div><br> <p>3.3: 实现监听 tomcat 关闭时的监听器</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* @program:
* @Date: 2019/9/13 0013 14:46
* @Author: guoMingCheng
* @Description:
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServletContextListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">{</span>
 <span class="token annotation punctuation">@Override</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> servletContextEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

 <span class="token punctuation">}</span>

 <span class="token annotation punctuation">@Override</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> servletContextEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

     <span class="token comment">//这里如果Web应用拥有多个数据库的连接，可以一并关闭</span>
     <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> drivers <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getDrivers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Driver</span> driver <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token keyword">while</span> <span class="token punctuation">(</span>drivers<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">try</span> <span class="token punctuation">{</span>
             driver <span class="token operator">=</span> drivers<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">deregisterDriver</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token class-name">AbandonedConnectionCleanupThread</span><span class="token punctuation">.</span><span class="token function">checkedShutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">4、最终目录图结构 </span></p> <blockquote><p>安装上面的步骤搭建 ssm 框架，就可以编写业务了。下面这张图是 ssm 框架下的目录结构
<img src="/img/java/%E6%A1%86%E6%9E%B6/spring/spring-26.png" alt="An image"></p></blockquote></blockquote> <h2 id="ssm-集成-mp-plus"><a href="#ssm-集成-mp-plus" class="header-anchor">#</a> ssm 集成 mp-plus</h2> <h4 id="集成-mybatis-plus-让-rom-开发更加简单"><a href="#集成-mybatis-plus-让-rom-开发更加简单" class="header-anchor">#</a> <div class="biaoti2"></div> 集成 Mybatis-Plus 让 ROM 开发更加简单</h4> <blockquote><p><span id="gonglian" style="font-size:13px;">1、在 ssm jar包基础上添加 MP 的 jar </span></p> <blockquote><div class="language-xml extra-class"><pre class="language-xml"><code>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>   
</code></pre></div></blockquote></blockquote> <blockquote><p><span id="gonglian" style="font-size:13px;">2、使用 MP 的 sqlSession 工厂 </span></p> <blockquote><p>原始: 这是 mybatis 配置的 sqlSession 工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
  * SqlSession 工厂
* @param dataSource 数据源，会在 IOC 中获取
*/</span>
<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;sqlSessionFactoryBean&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">SqlSessionFactoryBean</span> <span class="token function">getSqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
   <span class="token class-name">SqlSessionFactoryBean</span> factoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   factoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 设置 MyBatis 配置文件路径</span>
   <span class="token comment">// factoryBean.setConfigLocation(new ClassPathResource(&quot;mybatis-config.xml&quot;));</span>
   <span class="token comment">// 设置 SQL 映射文件路径</span>
   factoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:mybatis/*.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 设置 JavaBean 类型别名，在 SQL 映射文件中就不用写全类名</span>
   factoryBean<span class="token punctuation">.</span><span class="token function">setTypeAliasesPackage</span><span class="token punctuation">(</span><span class="token string">&quot;com.guomingcheng.pojo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> factoryBean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>新的: 需要替换成 MP 的 sqlSession 工厂 <br>
区别: 原始的: <span id="gonglian">SqlSessionFactoryBean </span> 新的:  <span id="gonglian">MybatisSqlSessionFactoryBean</span></p> <div class="language-js extra-class"><pre class="language-js"><code>   <span class="token comment">/**
   * SqlSession 工厂
   * @param dataSource 数据源，会在 IOC 中获取
   */</span>
  @<span class="token function">Bean</span><span class="token punctuation">(</span><span class="token string">&quot;sqlSessionFactoryBean&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> MybatisSqlSessionFactoryBean <span class="token function">getSqlSessionFactoryBean</span><span class="token punctuation">(</span>DataSource dataSource<span class="token punctuation">)</span> throws IOException <span class="token punctuation">{</span>
      MybatisSqlSessionFactoryBean factoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MybatisSqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 设置 MyBatis 配置文件路径</span>
       <span class="token comment">//   factoryBean.setConfigLocation(new ClassPathResource(&quot;mybatis-config.xml&quot;));</span>
      <span class="token comment">// 设置 SQL 映射文件路径</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:mybatis/*.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 设置 JavaBean 类型别名，在 SQL 映射文件中就不用写全类名</span>
      factoryBean<span class="token punctuation">.</span><span class="token function">setTypeAliasesPackage</span><span class="token punctuation">(</span><span class="token string">&quot;com.guomingcheng.pojo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> factoryBean<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></blockquote></blockquote> <h2 id="ssm-整合-logback-日志"><a href="#ssm-整合-logback-日志" class="header-anchor">#</a> ssm 整合 logback 日志</h2> <blockquote><p><span id="gonglian"> 这不仅整合日志的框架，也是要统一日志框架。因为某些框架使用的不是 logback，我们需要把那些框架依赖的日志框架排除。通过 logback 官方提供适配器模式的日志框架替代那些框架底层使用别的日志框架。</span></p> <blockquote><p><span id="gonglian">1、排除框架依赖别的日志框架 </span> <br> 因 spring 的底层使用的是 commons-logging 日志框架，我们需要排除他</p> <div class="language-xml extra-class"><pre class="language-xml"><code>    <span class="token comment">&lt;!-- mvc 包含 spring 的核心 jar --&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
       &lt; artifactId&gt;spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
       <span class="token comment">&lt;!-- 移除 spring 依赖的日志 jar 包--&gt;</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-jcl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p><br><br> <span id="gonglian">2、添加 logback 依赖的 jar 包 </span> <br> 注意: 因为以排除掉 spring 依赖日志 jar 包。这次需要添加 jcl-over-slf4j 这个 jar, 这就是适配器 jar。每个日志框架，logback 都提供对应的适配器 jar</p> <div class="language-xml extra-class"><pre class="language-xml"><code>
   <span class="token comment">&lt;!-- 主实现类: 实现日志规范的 jar 包--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

   <span class="token comment">&lt;!-- 主实现类: 实现日志规范的 jar 包--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>logback-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

   <span class="token comment">&lt;!-- 定义日志规范 jar 包--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

   <span class="token comment">&lt;!-- 更换 spring 底层的日志依赖为 logback , 替换原来的 commons.logging 日志--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jcl-over-slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p><br><br> <span id="gonglian">3、添加 logback 核心配置文件 </span> <br> 在 resources 下创建一个名为 logback.xml 的文件，添加一下内容。这些内容皆是配置的内容。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1 seconds<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contextName</span><span class="token punctuation">&gt;</span></span>logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contextName</span><span class="token punctuation">&gt;</span></span>
 <span class="token comment">&lt;!--定义参数,后面可以通过${app.name}使用--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app.name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logback_test<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scheduler.manager.server.home<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>D:<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

 <span class="token comment">&lt;!--ConsoleAppender 用于在屏幕上输出日志--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!--定义了一个过滤器,在LEVEL之下的日志输出不会被打印出来--&gt;</span>
     <span class="token comment">&lt;!--这里定义了DEBUG，也就是控制台不会输出比 DEBUG 级别小的日志--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>DEBUG<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>   <span class="token comment">&lt;!-- trace、debug、info、warn、error  --&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!-- encoder 默认配置为PatternLayoutEncoder --&gt;</span>
     <span class="token comment">&lt;!--定义控制台输出格式--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} [%file : %line] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!--定义日志输出的路径--&gt;</span>
     <span class="token comment">&lt;!--这里的scheduler.manager.server.home 没有在上面的配置中设定，所以会使用java启动时配置的值--&gt;</span>
     <span class="token comment">&lt;!--比如通过 java -Dscheduler.manager.server.home=/path/to XXXX 配置该属性--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>${scheduler.manager.server.home}/logs/${app.name}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!--定义日志滚动的策略--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token comment">&lt;!--定义文件滚动时的文件名的格式--&gt;</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>${scheduler.manager.server.home}/logs/${app.name}.%d{yyyy-MM-dd.HH}.log.gz
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
         <span class="token comment">&lt;!--60天的时间周期，日志量最大20GB--&gt;</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
         <span class="token comment">&lt;!-- 该属性在 1.1.6版本后 才开始支持--&gt;</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>totalSizeCap</span><span class="token punctuation">&gt;</span></span>20GB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>totalSizeCap</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>

     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>triggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token comment">&lt;!--每个日志文件最大100MB--&gt;</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>triggeringPolicy</span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!--定义输出格式--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d [%thread] %-5level %logger{36} [%file : %line] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

 <span class="token comment">&lt;!--root是默认的logger 这里设定输出级别是debug--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>trace<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!--定义了两个appender，日志会通过往这两个appender里面写--&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>

 <span class="token comment">&lt;!--对于类路径以 com.example.logback 开头的Logger,输出级别设置为warn,并且只输出到控制台--&gt;</span>
 <span class="token comment">&lt;!--这个logger没有指定appender，它会继承root节点中定义的那些appender--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.example.logback<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>warn<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

 <span class="token comment">&lt;!--通过 LoggerFactory.getLogger(&quot;mytest&quot;) 可以获取到这个logger--&gt;</span>
 <span class="token comment">&lt;!--由于这个logger自动继承了root的appender，root中已经有stdout的appender了，自己这边又引入了stdout的appender--&gt;</span>
 <span class="token comment">&lt;!--如果没有设置 additivity=&quot;false&quot; ,就会导致一条日志在控制台输出两次的情况--&gt;</span>
 <span class="token comment">&lt;!--additivity表示要不要使用rootLogger配置的appender进行输出--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mytest<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>

 <span class="token comment">&lt;!--由于设置了 additivity=&quot;false&quot; ，所以输出时不会使用rootLogger的appender--&gt;</span>
 <span class="token comment">&lt;!--但是这个logger本身又没有配置appender，所以使用这个logger输出日志的话就不会输出到任何地方--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mytest2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p><br><br> <span id="gonglian">4、使用 logback 日志打印 </span></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//第一种的使用方法，之间通过 LoggerFactory 日志工厂获取日志对象</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestContoller</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">TestService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;holle&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token annotation punctuation">@ResponseBody</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       logger<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;holle wrod&quot;</span><span class="token punctuation">)</span>
       <span class="token keyword">return</span> <span class="token string">&quot;holle wrod&quot;</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 第二种使用的方法，添加 @Slf4j 注解，需要在 pom 文件添加 lombok jar 包。这样也可以获取日志对象，log 就是</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestContoller</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;holle&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token annotation punctuation">@ResponseBody</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       log<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;holle wrod&quot;</span><span class="token punctuation">)</span>
       <span class="token keyword">return</span> <span class="token string">&quot;holle wrod&quot;</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></blockquote></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java/基础/并发编程/基础概念.html" class="prev">
        并发编程
      </a></span> <span class="next"><a href="/java/框架/mybatis_plus/mybatis-plus.html">
        mybatisPlus
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ce1393de.js" defer></script><script src="/assets/js/2.ee68cb5d.js" defer></script><script src="/assets/js/21.fcc0c1f7.js" defer></script>
  </body>
</html>
