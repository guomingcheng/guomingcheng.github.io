<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Address.sol | 文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/index.css">
    <script src="/js/index.js"></script>
    <meta name="description" content="个人文档">
    
    <link rel="preload" href="/assets/css/0.styles.8cd2006c.css" as="style"><link rel="preload" href="/assets/js/app.ce1393de.js" as="script"><link rel="preload" href="/assets/js/2.ee68cb5d.js" as="script"><link rel="preload" href="/assets/js/52.9afafe11.js" as="script"><link rel="prefetch" href="/assets/js/10.fae9557b.js"><link rel="prefetch" href="/assets/js/11.ec03d5d9.js"><link rel="prefetch" href="/assets/js/12.aa5ec6e6.js"><link rel="prefetch" href="/assets/js/13.fa27dbe3.js"><link rel="prefetch" href="/assets/js/14.27428945.js"><link rel="prefetch" href="/assets/js/15.e19dc613.js"><link rel="prefetch" href="/assets/js/16.ac5d0041.js"><link rel="prefetch" href="/assets/js/17.b015baa0.js"><link rel="prefetch" href="/assets/js/18.d790bc9c.js"><link rel="prefetch" href="/assets/js/19.7f450609.js"><link rel="prefetch" href="/assets/js/20.504a3fd4.js"><link rel="prefetch" href="/assets/js/21.fcc0c1f7.js"><link rel="prefetch" href="/assets/js/22.1e27d5c1.js"><link rel="prefetch" href="/assets/js/23.e7de804c.js"><link rel="prefetch" href="/assets/js/24.89d96b41.js"><link rel="prefetch" href="/assets/js/25.47d860f4.js"><link rel="prefetch" href="/assets/js/26.03bbdba6.js"><link rel="prefetch" href="/assets/js/27.adba25d3.js"><link rel="prefetch" href="/assets/js/28.51f6ec86.js"><link rel="prefetch" href="/assets/js/29.3d75e6eb.js"><link rel="prefetch" href="/assets/js/3.af3b0f40.js"><link rel="prefetch" href="/assets/js/30.3ea92647.js"><link rel="prefetch" href="/assets/js/31.50e89190.js"><link rel="prefetch" href="/assets/js/32.2330f5a5.js"><link rel="prefetch" href="/assets/js/33.3db8ae98.js"><link rel="prefetch" href="/assets/js/34.b38625c8.js"><link rel="prefetch" href="/assets/js/35.49492a46.js"><link rel="prefetch" href="/assets/js/36.5a949c11.js"><link rel="prefetch" href="/assets/js/37.e1595cca.js"><link rel="prefetch" href="/assets/js/38.5e66f157.js"><link rel="prefetch" href="/assets/js/39.e118d131.js"><link rel="prefetch" href="/assets/js/4.dcedff1a.js"><link rel="prefetch" href="/assets/js/40.9b43fbc7.js"><link rel="prefetch" href="/assets/js/41.d9116c83.js"><link rel="prefetch" href="/assets/js/42.95c96c90.js"><link rel="prefetch" href="/assets/js/43.a92421aa.js"><link rel="prefetch" href="/assets/js/44.e19be0d2.js"><link rel="prefetch" href="/assets/js/45.def7c4a5.js"><link rel="prefetch" href="/assets/js/46.b4d92a6e.js"><link rel="prefetch" href="/assets/js/47.de8d2dc3.js"><link rel="prefetch" href="/assets/js/48.21f95edd.js"><link rel="prefetch" href="/assets/js/49.26d21bfa.js"><link rel="prefetch" href="/assets/js/5.1bf7576d.js"><link rel="prefetch" href="/assets/js/50.1ea86b8f.js"><link rel="prefetch" href="/assets/js/51.034e7576.js"><link rel="prefetch" href="/assets/js/53.688c4d83.js"><link rel="prefetch" href="/assets/js/54.13bfb729.js"><link rel="prefetch" href="/assets/js/55.e066dc58.js"><link rel="prefetch" href="/assets/js/56.c036e408.js"><link rel="prefetch" href="/assets/js/57.007d50cf.js"><link rel="prefetch" href="/assets/js/58.3f670fa2.js"><link rel="prefetch" href="/assets/js/59.f41e8ae6.js"><link rel="prefetch" href="/assets/js/6.8cf2a95e.js"><link rel="prefetch" href="/assets/js/60.f0fda430.js"><link rel="prefetch" href="/assets/js/61.ae4987fd.js"><link rel="prefetch" href="/assets/js/62.3c3e0b82.js"><link rel="prefetch" href="/assets/js/63.87900c10.js"><link rel="prefetch" href="/assets/js/64.9ffbb746.js"><link rel="prefetch" href="/assets/js/65.52ffe053.js"><link rel="prefetch" href="/assets/js/66.0b20125c.js"><link rel="prefetch" href="/assets/js/67.cd8a1668.js"><link rel="prefetch" href="/assets/js/68.97020436.js"><link rel="prefetch" href="/assets/js/69.533a79a4.js"><link rel="prefetch" href="/assets/js/7.299203e9.js"><link rel="prefetch" href="/assets/js/70.29933dd9.js"><link rel="prefetch" href="/assets/js/71.f88421fc.js"><link rel="prefetch" href="/assets/js/72.95de2bad.js"><link rel="prefetch" href="/assets/js/73.4a4257cc.js"><link rel="prefetch" href="/assets/js/74.659aab88.js"><link rel="prefetch" href="/assets/js/75.cadd4a65.js"><link rel="prefetch" href="/assets/js/76.254b9f42.js"><link rel="prefetch" href="/assets/js/77.e5b5a87b.js"><link rel="prefetch" href="/assets/js/78.b1b2dd8d.js"><link rel="prefetch" href="/assets/js/79.cbbbe000.js"><link rel="prefetch" href="/assets/js/8.c093787a.js"><link rel="prefetch" href="/assets/js/80.2b85c169.js"><link rel="prefetch" href="/assets/js/81.c6f26762.js"><link rel="prefetch" href="/assets/js/9.010ac11f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8cd2006c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/区块链.html" class="nav-link">
  区块链
</a></div><div class="nav-item"><a href="/英语.html" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/前端.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/疑问解述篇.html" class="nav-link">
  疑问解述篇
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/区块链.html" class="nav-link">
  区块链
</a></div><div class="nav-item"><a href="/英语.html" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/前端.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/疑问解述篇.html" class="nav-link">
  疑问解述篇
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>以太坊</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/区块链/以太坊/以太坊-0001.html" class="sidebar-link">概念</a></li><li><a href="/区块链/以太坊/solidity.html" class="sidebar-link">solidity</a></li><li><a href="/区块链/以太坊/web3.0.html" class="sidebar-link">web3</a></li><li><a href="/区块链/以太坊/ethers.html" class="sidebar-link">ethers</a></li><li><a href="/区块链/以太坊/keystore 私钥加密.html" class="sidebar-link">keystore 私钥加密</a></li><li><a href="/区块链/以太坊/open 升级合约.html" class="sidebar-link">open 升级合约</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>交易所</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="address-sol"><a href="#address-sol" class="header-anchor">#</a> Address.sol</h2> <blockquote><p><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: MIT</span>
<span class="token comment">// OpenZeppelin Contracts (last updated v4.5.0) (utils/Address.sol)</span>

pragma solidity <span class="token operator">^</span><span class="token number">0.8</span><span class="token number">.1</span><span class="token punctuation">;</span>


<span class="token comment">/**
 * 类型: 库
 * 接口: public- internal-
 * @dev 与地址类型相关的函数集合库
 */</span>
library Address <span class="token punctuation">{</span>
    <span class="token comment">/**
     * @dev 如果 `account`是一个合约地址，则返回 true
     *
     * [ 作用 ]
     *  可以用来判断一个地址，是否是合约地址
     *
     * [ 原文建议 ]
     *  不应该依靠 isContract 来抵挡闪电贷的功能, 也会阻止来自合约的呼叫，这样会打破合约的可互相访问的特性
     */</span>
    <span class="token keyword">function</span> <span class="token function">isContract</span><span class="token punctuation">(</span><span class="token parameter">address account</span><span class="token punctuation">)</span> internal view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// account.code.length 是读取存放代码空间的长度, 长度大于 0, 就表示是合约地址</span>
        <span class="token keyword">return</span> account<span class="token punctuation">.</span>code<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev 如果当前合约的 balance &gt; amount, 则向 recipient 地址转入 amount 数量的以太坊
     *
     * [ 作用 ]
     *  转账, 合约向 recipient 转   
     */</span>
    <span class="token keyword">function</span> <span class="token function">sendValue</span><span class="token punctuation">(</span><span class="token parameter">address payable recipient<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token comment">//当前合约的 eth 必须大于 amount</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&gt;=</span> amount<span class="token punctuation">,</span> <span class="token string">&quot;Address: insufficient balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// Call 底层呼叫函数, {value: amount} 表示等于向对方转入 eth, (&quot;&quot;) 表示调用接口的二进制编码</span>
        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">=</span> recipient<span class="token punctuation">.</span>call<span class="token punctuation">{</span>value<span class="token operator">:</span> amount<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">&quot;Address: unable to send value, recipient may have reverted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev 使用底层 call 函数通过二进制接口调用合约函数
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionCall</span><span class="token punctuation">(</span><span class="token parameter">address target<span class="token punctuation">,</span> bytes memory data</span><span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">functionCall</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token string">&quot;Address: low-level call failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev 使用底层 call 函数通过二进制接口调用合约函数
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionCall</span><span class="token punctuation">(</span>
        <span class="token parameter">address target<span class="token punctuation">,</span>
        bytes memory data<span class="token punctuation">,</span>
        string memory errorMessage</span>
    <span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">functionCallWithValue</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev 使用底层 call 函数通过二进制接口调用合约函数，并可转入 eth
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionCallWithValue</span><span class="token punctuation">(</span>
        address target<span class="token punctuation">,</span>
        bytes memory data<span class="token punctuation">,</span>       <span class="token comment">//接口的二进制编码</span>
        uint256 value            <span class="token comment">//向合约地址转入 value 数量的 eth </span>
    <span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">functionCallWithValue</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> data<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Address: low-level call with value failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 重载方法   
     * @dev 调用一个合约的函数，并可转入 eth
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionCallWithValue</span><span class="token punctuation">(</span>
        address target<span class="token punctuation">,</span>           
        bytes memory data<span class="token punctuation">,</span>       <span class="token comment">//接口的二进制编码</span>
        uint256 value<span class="token punctuation">,</span>           <span class="token comment">//向合约地址转入 value 数量的 eth </span>
        string memory errorMessage
    <span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&gt;=</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Address: insufficient balance for call&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">isContract</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Address: call to non-contract&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//验证地址是否是合约地址，否则就不调用</span>

        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> bytes memory returndata<span class="token punctuation">)</span> <span class="token operator">=</span> target<span class="token punctuation">.</span>call<span class="token punctuation">{</span>value<span class="token operator">:</span> value<span class="token punctuation">}</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 执行底层呼叫调用</span>
        <span class="token keyword">return</span> <span class="token function">verifyCallResult</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> returndata<span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a static call.
     *
     * _Available since v3.3._
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionStaticCall</span><span class="token punctuation">(</span><span class="token parameter">address target<span class="token punctuation">,</span> bytes memory data</span><span class="token punctuation">)</span> internal view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">functionStaticCall</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token string">&quot;Address: low-level static call failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
     * but performing a static call.
     *
     * _Available since v3.3._
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionStaticCall</span><span class="token punctuation">(</span>
        <span class="token parameter">address target<span class="token punctuation">,</span>
        bytes memory data<span class="token punctuation">,</span>
        string memory errorMessage</span>
    <span class="token punctuation">)</span> internal view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">isContract</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Address: static call to non-contract&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> bytes memory returndata<span class="token punctuation">)</span> <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">staticcall</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">verifyCallResult</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> returndata<span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a delegate call.
     *
     * _Available since v3.4._
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionDelegateCall</span><span class="token punctuation">(</span><span class="token parameter">address target<span class="token punctuation">,</span> bytes memory data</span><span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">functionDelegateCall</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token string">&quot;Address: low-level delegate call failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
     * but performing a delegate call.
     *
     * _Available since v3.4._
     */</span>
    <span class="token keyword">function</span> <span class="token function">functionDelegateCall</span><span class="token punctuation">(</span>
        <span class="token parameter">address target<span class="token punctuation">,</span>
        bytes memory data<span class="token punctuation">,</span>
        string memory errorMessage</span>
    <span class="token punctuation">)</span> internal <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">isContract</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Address: delegate call to non-contract&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> bytes memory returndata<span class="token punctuation">)</span> <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">delegatecall</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">verifyCallResult</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> returndata<span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Tool to verifies that a low level call was successful, and revert if it wasn't, either by bubbling the
     * revert reason using the provided one.
     *
     * _Available since v4.3._
     */</span>
    <span class="token keyword">function</span> <span class="token function">verifyCallResult</span><span class="token punctuation">(</span>
        <span class="token parameter">bool success<span class="token punctuation">,</span>
        bytes memory returndata<span class="token punctuation">,</span>
        string memory errorMessage</span>
    <span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> returndata<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// Look for revert reason and bubble it up if present</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>returndata<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// The easiest way to bubble the revert reason is using memory via assembly</span>

                assembly <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> returndata_size <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">mload</span><span class="token punctuation">(</span>returndata<span class="token punctuation">)</span>
                    <span class="token function">revert</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> returndata<span class="token punctuation">)</span><span class="token punctuation">,</span> returndata_size<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">revert</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="context-sol"><a href="#context-sol" class="header-anchor">#</a> Context.sol</h2> <blockquote><p><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Context.sol" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: MIT</span>
<span class="token comment">// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>

pragma solidity <span class="token operator">^</span><span class="token number">0.8</span><span class="token number">.0</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 类型: 抽象合约
 * 接口: public-2 internal-
 * @dev 读取上下文调用合约的发送者，用于内部访问
 */</span>
abstract contract Context <span class="token punctuation">{</span>
    <span class="token comment">// virtual 关键字表明的方法，表示当前方法是可以被重写</span>
    <span class="token keyword">function</span> <span class="token function">_msgSender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> internal view virtual <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">address payable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">_msgData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> internal view virtual <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes memory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="safeerc20-sol"><a href="#safeerc20-sol" class="header-anchor">#</a> SafeERC20.sol</h2> <blockquote><p><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SPDX-License-Identifier: MIT</span>
<span class="token comment">// OpenZeppelin Contracts v4.4.1 (token/ERC20/utils/SafeERC20.sol)</span>

pragma solidity <span class="token operator">^</span><span class="token number">0.8</span><span class="token number">.0</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">&quot;../IERC20.sol&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;../../../utils/Address.sol&quot;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 类型: 库合约
 * 接口: public-2 internal-
 * @dev 安全发送, 调用标准的 ERC-20 合约
 */</span>
library SafeERC20 <span class="token punctuation">{</span>

    <span class="token comment">//需要引入 address 地址的库文件, 需要调用</span>
    using Address <span class="token keyword">for</span> address<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">safeTransfer</span><span class="token punctuation">(</span>
        <span class="token constant">IERC20</span> token<span class="token punctuation">,</span>        <span class="token comment">//ERC-20 代币合约的地址</span>
        address to<span class="token punctuation">,</span>          <span class="token comment">//目标地址，将会向这个地址转入 ERC-20 代币   </span>
        uint256 value        <span class="token comment">//数额 </span>
    <span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token comment">//token.transfer.selector : 获取 IERC20 接口内的 tranfer 函数命包含参数的字符串</span>
        <span class="token comment">//abi.encodeWithSelector(token.transfer.selector, to, value)   : 编译成二进制编码</span>
        <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>transfer<span class="token punctuation">.</span>selector<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">safeTransferFrom</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token constant">IERC20</span> token<span class="token punctuation">,</span>
        address from<span class="token punctuation">,</span>
        address to<span class="token punctuation">,</span>
        uint256 value</span>
    <span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>transferFrom<span class="token punctuation">.</span>selector<span class="token punctuation">,</span> from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Deprecated. This function has issues similar to the ones found in
     * {IERC20-approve}, and its usage is discouraged.
     *
     * Whenever possible, use {safeIncreaseAllowance} and
     * {safeDecreaseAllowance} instead.
     */</span>
    <span class="token keyword">function</span> <span class="token function">safeApprove</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token constant">IERC20</span> token<span class="token punctuation">,</span>
        address spender<span class="token punctuation">,</span>
        uint256 value</span>
    <span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token comment">// safeApprove should only be called when setting an initial allowance,</span>
        <span class="token comment">// or when resetting it to zero. To increase and decrease it, use</span>
        <span class="token comment">// 'safeIncreaseAllowance' and 'safeDecreaseAllowance'</span>
        <span class="token function">require</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">allowance</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>approve<span class="token punctuation">.</span>selector<span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">safeIncreaseAllowance</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token constant">IERC20</span> token<span class="token punctuation">,</span>
        address spender<span class="token punctuation">,</span>
        uint256 value</span>
    <span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        uint256 newAllowance <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">allowance</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
        <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>approve<span class="token punctuation">.</span>selector<span class="token punctuation">,</span> spender<span class="token punctuation">,</span> newAllowance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">safeDecreaseAllowance</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token constant">IERC20</span> token<span class="token punctuation">,</span>
        address spender<span class="token punctuation">,</span>
        uint256 value</span>
    <span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        unchecked <span class="token punctuation">{</span>
            uint256 oldAllowance <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">allowance</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">require</span><span class="token punctuation">(</span>oldAllowance <span class="token operator">&gt;=</span> value<span class="token punctuation">,</span> <span class="token string">&quot;SafeERC20: decreased allowance below zero&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            uint256 newAllowance <span class="token operator">=</span> oldAllowance <span class="token operator">-</span> value<span class="token punctuation">;</span>
            <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>approve<span class="token punctuation">.</span>selector<span class="token punctuation">,</span> spender<span class="token punctuation">,</span> newAllowance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement
     * on the return value: the return value is optional (but if data is returned, it must not be false).
     * @param token The token targeted by the call.
     * @param data The call data (encoded using abi.encode or one of its variants).
     */</span>
    <span class="token keyword">function</span> <span class="token function">_callOptionalReturn</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">IERC20</span> token<span class="token punctuation">,</span> bytes memory data</span><span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token punctuation">{</span>
        <span class="token comment">// We need to perform a low level call here, to bypass Solidity's return data size checking mechanism, since</span>
        <span class="token comment">// we're implementing it ourselves. We use {Address.functionCall} to perform this call, which verifies that</span>
        <span class="token comment">// the target address contains contract code and also asserts for success in the low-level call.</span>

        bytes memory returndata <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functionCall</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&quot;SafeERC20: low-level call failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>returndata<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Return data is optional</span>
            <span class="token function">require</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>returndata<span class="token punctuation">,</span> <span class="token punctuation">(</span>bool<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;SafeERC20: ERC20 operation did not succeed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="safemath"><a href="#safemath" class="header-anchor">#</a> SafeMath</h2> <blockquote><p><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/SafeMath.sol" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
  *  类型：库类
  *  接口：internal=10
  *  说明：安全数学，用于计算 + - * / 的。
  */</span>
library SafeMath <span class="token punctuation">{</span>
    
    <span class="token comment">//功能： ＋   </span>
    <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span> uint256 b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        uint256 c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>c <span class="token operator">&gt;=</span> a<span class="token punctuation">,</span> <span class="token string">'SafeMath: addition overflow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： -</span>
    <span class="token keyword">function</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span> uint256 b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">sub</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token string">'SafeMath: subtraction overflow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： -</span>
    <span class="token keyword">function</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span>uint256 b<span class="token punctuation">,</span>string memory errorMessage</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>b <span class="token operator">&lt;=</span> a<span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        uint256 c <span class="token operator">=</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>

        <span class="token keyword">return</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： *</span>
    <span class="token keyword">function</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span> uint256 b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        uint256 c <span class="token operator">=</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>c <span class="token operator">/</span> a <span class="token operator">==</span> b<span class="token punctuation">,</span> <span class="token string">'SafeMath: multiplication overflow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： /</span>
    <span class="token keyword">function</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span> uint256 b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">div</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token string">'SafeMath: division by zero'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： /</span>
    <span class="token keyword">function</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token parameter">uint256 b<span class="token punctuation">,</span> string memory errorMessage</span>  <span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        uint256 c <span class="token operator">=</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
        <span class="token comment">// assert(a == b * c + a % b); // There is no case in which this doesn't hold</span>
        <span class="token keyword">return</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： %</span>
    <span class="token keyword">function</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token parameter">uint256 a<span class="token punctuation">,</span> uint256 b</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">mod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token string">'SafeMath: modulo by zero'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//功能： %</span>
    <span class="token keyword">function</span> <span class="token function">mod</span><span class="token punctuation">(</span> <span class="token parameter">uint256 a<span class="token punctuation">,</span>uint256 b<span class="token punctuation">,</span>string memory errorMessage</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> a <span class="token operator">%</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//功能： 最小值</span>
    <span class="token keyword">function</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token parameter">uint256 x<span class="token punctuation">,</span> uint256 y</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256 z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        z <span class="token operator">=</span> x <span class="token operator">&lt;</span> y <span class="token operator">?</span> x <span class="token operator">:</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// babylonian method (https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method)</span>
    <span class="token keyword">function</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token parameter">uint256 y</span><span class="token punctuation">)</span> internal pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint256 z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            z <span class="token operator">=</span> y<span class="token punctuation">;</span>
            uint256 x <span class="token operator">=</span> y <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> z<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                z <span class="token operator">=</span> x<span class="token punctuation">;</span>
                x <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">/</span> x <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ce1393de.js" defer></script><script src="/assets/js/2.ee68cb5d.js" defer></script><script src="/assets/js/52.9afafe11.js" defer></script>
  </body>
</html>
